<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>leafcutter2 - check result</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">leafcutter2</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#where-did-the-bug-come-from" id="toc-where-did-the-bug-come-from" class="nav-link active" data-scroll-target="#where-did-the-bug-come-from">where did the bug come from?</a></li>
  <li><a href="#check-v1-leafcutter_regtools-vs.-v2-leafcutter_regtools" id="toc-check-v1-leafcutter_regtools-vs.-v2-leafcutter_regtools" class="nav-link" data-scroll-target="#check-v1-leafcutter_regtools-vs.-v2-leafcutter_regtools">check v1 leafcutter_regtools vs.&nbsp;v2 leafcutter_regtools</a>
  <ul class="collapse">
  <li><a href="#run1-results---og-script-with-0based-intron-and-1off-bug" id="toc-run1-results---og-script-with-0based-intron-and-1off-bug" class="nav-link" data-scroll-target="#run1-results---og-script-with-0based-intron-and-1off-bug">run1 results - OG script with 0based intron, and 1off bug</a></li>
  <li><a href="#run2-results---new-script-with-1off-bug-fix" id="toc-run2-results---new-script-with-1off-bug-fix" class="nav-link" data-scroll-target="#run2-results---new-script-with-1off-bug-fix">run2 results - new script with 1off bug fix</a></li>
  <li><a href="#run1--run2---compare-annot" id="toc-run1--run2---compare-annot" class="nav-link" data-scroll-target="#run1--run2---compare-annot">run1 -run2 - compare annot</a>
  <ul class="collapse">
  <li><a href="#overall-differences-by-category" id="toc-overall-differences-by-category" class="nav-link" data-scroll-target="#overall-differences-by-category">Overall differences by category</a></li>
  <li><a href="#check-all-coordinates-are-the-same" id="toc-check-all-coordinates-are-the-same" class="nav-link" data-scroll-target="#check-all-coordinates-are-the-same">Check all coordinates are the same</a></li>
  <li><a href="#introns-with-same-classification" id="toc-introns-with-same-classification" class="nav-link" data-scroll-target="#introns-with-same-classification">introns with same classification</a></li>
  <li><a href="#introns-with-diff-classification" id="toc-introns-with-diff-classification" class="nav-link" data-scroll-target="#introns-with-diff-classification">introns with diff classification</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#check-v2-classifier-vs.-qns-classifier-results" id="toc-check-v2-classifier-vs.-qns-classifier-results" class="nav-link" data-scroll-target="#check-v2-classifier-vs.-qns-classifier-results">Check v2 Classifier vs.&nbsp;Qn’s Classifier results</a>
  <ul class="collapse">
  <li><a href="#introns-where-qns-is-7-and-v2onbed-is-not" id="toc-introns-where-qns-is-7-and-v2onbed-is-not" class="nav-link" data-scroll-target="#introns-where-qns-is-7-and-v2onbed-is-not">Introns where qn’s is 7 and v2onBed is not</a></li>
  <li><a href="#both-version-joins-completelly-on-coordinates-so-the-coordinates-are-the-same." id="toc-both-version-joins-completelly-on-coordinates-so-the-coordinates-are-the-same." class="nav-link" data-scroll-target="#both-version-joins-completelly-on-coordinates-so-the-coordinates-are-the-same.">Both version joins completelly on coordinates, so the coordinates are the same.</a></li>
  <li><a href="#whats-the-difference-in-introns-in-classfications-vs.-in-counts" id="toc-whats-the-difference-in-introns-in-classfications-vs.-in-counts" class="nav-link" data-scroll-target="#whats-the-difference-in-introns-in-classfications-vs.-in-counts">what’s the difference in introns in classfications vs.&nbsp;in counts?</a></li>
  </ul></li>
  <li><a href="#check-v2-classifier-vs.-v3-classifier" id="toc-check-v2-classifier-vs.-v3-classifier" class="nav-link" data-scroll-target="#check-v2-classifier-vs.-v3-classifier">Check v2 Classifier vs.&nbsp;v3 Classifier</a></li>
  <li><a href="#check-qns-classifer-vs.-qns-classifier-with-bed-v2-results" id="toc-check-qns-classifer-vs.-qns-classifier-with-bed-v2-results" class="nav-link" data-scroll-target="#check-qns-classifer-vs.-qns-classifier-with-bed-v2-results">Check Qns’ classifer vs.&nbsp;Qn’s Classifier with BED (v2) results</a></li>
  <li><a href="#check-v1-leafcutter_regtools-vs.-v2-updated-leafcutter_regtools" id="toc-check-v1-leafcutter_regtools-vs.-v2-updated-leafcutter_regtools" class="nav-link" data-scroll-target="#check-v1-leafcutter_regtools-vs.-v2-updated-leafcutter_regtools">check v1 leafcutter_regtools vs.&nbsp;v2 updated leafcutter_regtools</a>
  <ul class="collapse">
  <li><a href="#run1-results---og-script-with-0based-intron-and-1off-bug-1" id="toc-run1-results---og-script-with-0based-intron-and-1off-bug-1" class="nav-link" data-scroll-target="#run1-results---og-script-with-0based-intron-and-1off-bug-1">run1 results - OG script with 0based intron, and 1off bug</a></li>
  <li><a href="#run3-results---bug-fixed-plus-quinns-update" id="toc-run3-results---bug-fixed-plus-quinns-update" class="nav-link" data-scroll-target="#run3-results---bug-fixed-plus-quinns-update">run3 results - bug fixed plus Quinn’s update</a></li>
  <li><a href="#run1--run3---compare-annot" id="toc-run1--run3---compare-annot" class="nav-link" data-scroll-target="#run1--run3---compare-annot">run1 -run3 - compare annot</a>
  <ul class="collapse">
  <li><a href="#overall-differences-by-category-1" id="toc-overall-differences-by-category-1" class="nav-link" data-scroll-target="#overall-differences-by-category-1">Overall differences by category</a></li>
  <li><a href="#check-all-coordinates-are-the-same-1" id="toc-check-all-coordinates-are-the-same-1" class="nav-link" data-scroll-target="#check-all-coordinates-are-the-same-1">Check all coordinates are the same</a></li>
  <li><a href="#introns-with-same-classification-1" id="toc-introns-with-same-classification-1" class="nav-link" data-scroll-target="#introns-with-same-classification-1">introns with same classification</a></li>
  <li><a href="#introns-with-diff-classification-1" id="toc-introns-with-diff-classification-1" class="nav-link" data-scroll-target="#introns-with-diff-classification-1">introns with diff classification</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">check result</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="where-did-the-bug-come-from" class="level1">
<h1>where did the bug come from?</h1>
<p>The problem is the original SpliceJunctionClassifier.py expects input count coordinates be exactly like leafcutter1, which is not BED or VCF format. All procedures prior to that step in leafcutter2 produces BED formatted coordinates.</p>
<p><strong>Fix:</strong></p>
<p>In the SpliceJunctionClassifer function, convert perind.counts.gz coordinates into leafcutter1, run through procedure, then convert back to BED formatted before writing any output. All outputs will be back to BED format.</p>
<table class="table">
<thead>
<tr class="header">
<th>BED</th>
<th>VCF</th>
<th>Leafcutter1</th>
<th>Leafcutter2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>chr1:100-200</td>
<td>chr1:101-200</td>
<td>chr1:100-201</td>
<td>chr1:100-200</td>
</tr>
</tbody>
</table>
<ul>
<li>Regtools extracted junctions are in BED12 format which uses the same BED format (0-based left closed, right open).</li>
<li>Leafcutter2 follows exact same format as BED</li>
<li>Leafcutter1 converts from BED (chrom, start, end +1 ).</li>
</ul>
</section>
<section id="check-v1-leafcutter_regtools-vs.-v2-leafcutter_regtools" class="level1">
<h1>check v1 leafcutter_regtools vs.&nbsp;v2 leafcutter_regtools</h1>
<section id="run1-results---og-script-with-0based-intron-and-1off-bug" class="level2">
<h2 class="anchored" data-anchor-id="run1-results---og-script-with-0based-intron-and-1off-bug">run1 results - OG script with 0based intron, and 1off bug</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># classified junctions</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>jfc1 <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">"./run1/run1_junction_classifications.txt"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>cnts1 <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">"./run1/run1_perind.counts.noise_by_intron.gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>cnts1[, itype <span class="sc">:</span><span class="er">=</span> <span class="fu">str_extract</span>(chrom, <span class="st">"</span><span class="sc">\\</span><span class="st">w+$"</span>)]</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>cnts1[, coord <span class="sc">:</span><span class="er">=</span> <span class="fu">str_remove</span>(chrom, <span class="st">"</span><span class="sc">\\</span><span class="st">:</span><span class="sc">\\</span><span class="st">w+$"</span>)]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># jfc1[, key := map_vec(Intron_coord, coord_to_key)]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cnts1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           chrom NA18486.junc NA18487.junc NA18488.junc
                          &lt;char&gt;       &lt;char&gt;       &lt;char&gt;       &lt;char&gt;
1: chr1:827775:829002:clu_1_+:IN        21/24        15/18          7/9
2: chr1:827849:829002:clu_1_+:IN         3/24         0/18          0/9
3: chr1:827853:829002:clu_1_+:IN         0/24         3/18          2/9
4: chr1:829104:841199:clu_2_+:IN        11/39         6/25         8/16
5: chr1:829104:847653:clu_2_+:IN         4/39         3/25         3/16
6: chr1:829104:851926:clu_2_+:IN         7/39         8/25         0/16
   NA184898.junc NA184899.junc NA18489.junc  itype                      coord
          &lt;char&gt;        &lt;char&gt;       &lt;char&gt; &lt;char&gt;                     &lt;char&gt;
1:         27/28           8/9        25/30     IN chr1:827775:829002:clu_1_+
2:          1/28           1/9         2/30     IN chr1:827849:829002:clu_1_+
3:          0/28           0/9         3/30     IN chr1:827853:829002:clu_1_+
4:          7/28          3/11        14/33     IN chr1:829104:841199:clu_2_+
5:          7/28          3/11         4/33     IN chr1:829104:847653:clu_2_+
6:          4/28          1/11         5/33     IN chr1:829104:851926:clu_2_+</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cnts1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9301    9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(cnts1<span class="sc">$</span>itype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "IN" "UP" "PR" "NE"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cnts1[, .N, by <span class="ot">=</span> itype][, .(itype, N, <span class="at">P =</span> N<span class="sc">/</span><span class="fu">sum</span>(N))][<span class="fu">order</span>(<span class="sc">-</span>N)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    itype     N          P
   &lt;char&gt; &lt;int&gt;      &lt;num&gt;
1:     PR  5520 0.59348457
2:     UP  2788 0.29975271
3:     NE   555 0.05967100
4:     IN   438 0.04709171</code></pre>
</div>
</div>
</section>
<section id="run2-results---new-script-with-1off-bug-fix" class="level2">
<h2 class="anchored" data-anchor-id="run2-results---new-script-with-1off-bug-fix">run2 results - new script with 1off bug fix</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># classified junctions</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>jfc2 <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">"./run2/run2_junction_classifications.txt"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>cnts2 <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">"./run2/run2_perind.counts.noise_by_intron.gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>cnts2[, itype <span class="sc">:</span><span class="er">=</span> <span class="fu">str_extract</span>(chrom, <span class="st">"</span><span class="sc">\\</span><span class="st">w+$"</span>)]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>cnts2[, coord <span class="sc">:</span><span class="er">=</span> <span class="fu">str_remove</span>(chrom, <span class="st">"</span><span class="sc">\\</span><span class="st">:</span><span class="sc">\\</span><span class="st">w+$"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cnts2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           chrom NA18486.junc NA18487.junc NA18488.junc
                          &lt;char&gt;       &lt;char&gt;       &lt;char&gt;       &lt;char&gt;
1: chr1:827775:829002:clu_1_+:IN        21/24        15/18          7/9
2: chr1:827849:829002:clu_1_+:IN         3/24         0/18          0/9
3: chr1:827853:829002:clu_1_+:IN         0/24         3/18          2/9
4: chr1:829104:841199:clu_2_+:IN        11/39         6/25         8/16
5: chr1:829104:847653:clu_2_+:IN         4/39         3/25         3/16
6: chr1:829104:851926:clu_2_+:IN         7/39         8/25         0/16
   NA184898.junc NA184899.junc NA18489.junc  itype                      coord
          &lt;char&gt;        &lt;char&gt;       &lt;char&gt; &lt;char&gt;                     &lt;char&gt;
1:         27/28           8/9        25/30     IN chr1:827775:829002:clu_1_+
2:          1/28           1/9         2/30     IN chr1:827849:829002:clu_1_+
3:          0/28           0/9         3/30     IN chr1:827853:829002:clu_1_+
4:          7/28          3/11        14/33     IN chr1:829104:841199:clu_2_+
5:          7/28          3/11         4/33     IN chr1:829104:847653:clu_2_+
6:          4/28          1/11         5/33     IN chr1:829104:851926:clu_2_+</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cnts2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9301    9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(cnts2<span class="sc">$</span>itype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "IN" "PR" "UP" "NE"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>cnts2[, .N, by <span class="ot">=</span> itype][, .(itype, N, <span class="at">P =</span> N<span class="sc">/</span><span class="fu">sum</span>(N))][<span class="fu">order</span>(<span class="sc">-</span>N)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    itype     N          P
   &lt;char&gt; &lt;int&gt;      &lt;num&gt;
1:     PR  6239 0.67078809
2:     UP  2155 0.23169552
3:     NE   469 0.05042469
4:     IN   438 0.04709171</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># jfc2[, key := map_vec(Intron_coord, coord_to_key)]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="run1--run2---compare-annot" class="level2">
<h2 class="anchored" data-anchor-id="run1--run2---compare-annot">run1 -run2 - compare annot</h2>
<section id="overall-differences-by-category" class="level3">
<h3 class="anchored" data-anchor-id="overall-differences-by-category">Overall differences by category</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<div id="gphgcpsmea" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gphgcpsmea table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gphgcpsmea thead, #gphgcpsmea tbody, #gphgcpsmea tfoot, #gphgcpsmea tr, #gphgcpsmea td, #gphgcpsmea th {
  border-style: none;
}

#gphgcpsmea p {
  margin: 0;
  padding: 0;
}

#gphgcpsmea .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gphgcpsmea .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gphgcpsmea .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gphgcpsmea .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gphgcpsmea .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gphgcpsmea .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gphgcpsmea .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gphgcpsmea .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gphgcpsmea .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gphgcpsmea .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gphgcpsmea .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gphgcpsmea .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gphgcpsmea .gt_spanner_row {
  border-bottom-style: hidden;
}

#gphgcpsmea .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gphgcpsmea .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gphgcpsmea .gt_from_md > :first-child {
  margin-top: 0;
}

#gphgcpsmea .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gphgcpsmea .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gphgcpsmea .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gphgcpsmea .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gphgcpsmea .gt_row_group_first td {
  border-top-width: 2px;
}

#gphgcpsmea .gt_row_group_first th {
  border-top-width: 2px;
}

#gphgcpsmea .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gphgcpsmea .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gphgcpsmea .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gphgcpsmea .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gphgcpsmea .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gphgcpsmea .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gphgcpsmea .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gphgcpsmea .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gphgcpsmea .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gphgcpsmea .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gphgcpsmea .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gphgcpsmea .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gphgcpsmea .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gphgcpsmea .gt_left {
  text-align: left;
}

#gphgcpsmea .gt_center {
  text-align: center;
}

#gphgcpsmea .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gphgcpsmea .gt_font_normal {
  font-weight: normal;
}

#gphgcpsmea .gt_font_bold {
  font-weight: bold;
}

#gphgcpsmea .gt_font_italic {
  font-style: italic;
}

#gphgcpsmea .gt_super {
  font-size: 65%;
}

#gphgcpsmea .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gphgcpsmea .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gphgcpsmea .gt_indent_1 {
  text-indent: 5px;
}

#gphgcpsmea .gt_indent_2 {
  text-indent: 10px;
}

#gphgcpsmea .gt_indent_3 {
  text-indent: 15px;
}

#gphgcpsmea .gt_indent_4 {
  text-indent: 20px;
}

#gphgcpsmea .gt_indent_5 {
  text-indent: 25px;
}

#gphgcpsmea .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#gphgcpsmea div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="itype" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">itype</th>
<th id="N.run1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">N.run1</th>
<th id="P.run1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">P.run1</th>
<th id="N.run2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">N.run2</th>
<th id="P.run2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">P.run2</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="itype">PR</td>
<td class="gt_row gt_right" headers="N.run1">5520</td>
<td class="gt_row gt_right" headers="P.run1">0.59348457</td>
<td class="gt_row gt_right" headers="N.run2">6239</td>
<td class="gt_row gt_right" headers="P.run2">0.67078809</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="itype">UP</td>
<td class="gt_row gt_right" headers="N.run1">2788</td>
<td class="gt_row gt_right" headers="P.run1">0.29975271</td>
<td class="gt_row gt_right" headers="N.run2">2155</td>
<td class="gt_row gt_right" headers="P.run2">0.23169552</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="itype">NE</td>
<td class="gt_row gt_right" headers="N.run1">555</td>
<td class="gt_row gt_right" headers="P.run1">0.05967100</td>
<td class="gt_row gt_right" headers="N.run2">469</td>
<td class="gt_row gt_right" headers="P.run2">0.05042469</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="itype">IN</td>
<td class="gt_row gt_right" headers="N.run1">438</td>
<td class="gt_row gt_right" headers="P.run1">0.04709171</td>
<td class="gt_row gt_right" headers="N.run2">438</td>
<td class="gt_row gt_right" headers="P.run2">0.04709171</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="check-all-coordinates-are-the-same" class="level3">
<h3 class="anchored" data-anchor-id="check-all-coordinates-are-the-same">Check all coordinates are the same</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">uniqueN</span>(cnts1<span class="sc">$</span>coord), <span class="fu">uniqueN</span>(cnts1<span class="sc">$</span>coord), <span class="fu">nrow</span>(cnts1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9301 9301 9301</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">uniqueN</span>(cnts2<span class="sc">$</span>coord), <span class="fu">uniqueN</span>(cnts2<span class="sc">$</span>coord), <span class="fu">nrow</span>(cnts2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9301 9301 9301</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">intersect</span>(cnts1<span class="sc">$</span>coord, cnts2<span class="sc">$</span>coord) <span class="sc">%&gt;%</span> <span class="fu">uniqueN</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9301</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>checkdf <span class="ot">=</span> <span class="fu">left_join</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  cnts1[, .(coord, itype)],</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  cnts2[, .(coord, itype)],</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"coord"</span>, <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">".run1"</span>, <span class="st">".run2"</span>),</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">same =</span> itype.run1 <span class="sc">==</span> itype.run2) <span class="sc">%&gt;%</span> </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">itype2 =</span> <span class="fu">paste0</span>(itype.run1, <span class="st">","</span>, itype.run2)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="introns-with-same-classification" class="level3">
<h3 class="anchored" data-anchor-id="introns-with-same-classification">introns with same classification</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>checkdf[same <span class="sc">==</span> <span class="cn">TRUE</span>, .N, by <span class="ot">=</span> itype2][<span class="fu">order</span>(<span class="sc">-</span>N)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   itype2     N
   &lt;char&gt; &lt;int&gt;
1:  PR,PR  5497
2:  UP,UP  2140
3:  NE,NE   457
4:  IN,IN   438</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># checkdf[same == TRUE]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="introns-with-diff-classification" class="level3">
<h3 class="anchored" data-anchor-id="introns-with-diff-classification">introns with diff classification</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>checkdf[same <span class="sc">==</span> F, .N, by <span class="ot">=</span> itype2][<span class="fu">order</span>(<span class="sc">-</span>N)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   itype2     N
   &lt;char&gt; &lt;int&gt;
1:  UP,PR   644
2:  NE,PR    98
3:  PR,UP    15
4:  PR,NE     8
5:  UP,NE     4</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="check-v2-classifier-vs.-qns-classifier-results" class="level1">
<h1>Check v2 Classifier vs.&nbsp;Qn’s Classifier results</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>cnts1 <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">"./qn/toy_perind.counts.gz"</span>, <span class="at">header =</span> F, <span class="at">col.names =</span> <span class="st">"chrom"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>cnts2 <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">"./qn/toyBED_perind.counts.gz"</span>, <span class="at">header =</span> F, <span class="at">col.names =</span> <span class="st">"chrom"</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>cnts1 <span class="ot">=</span> <span class="fu">separate</span>(cnts1, chrom, <span class="fu">c</span>(<span class="st">"seqname"</span>, <span class="st">"start"</span>, <span class="st">"end"</span>, <span class="st">"clu"</span>), <span class="st">":"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"start"</span>, <span class="st">"end"</span>), as.integer) <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  as.data.table</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>cnts2 <span class="ot">=</span> <span class="fu">separate</span>(cnts2, chrom, <span class="fu">c</span>(<span class="st">"seqname"</span>, <span class="st">"start"</span>, <span class="st">"end"</span>, <span class="st">"clu"</span>), <span class="st">":"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"start"</span>, <span class="st">"end"</span>), as.integer) <span class="sc">%&gt;%</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">end2 =</span> end <span class="sc">+</span> <span class="dv">1</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  as.data.table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cnts1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   seqname start   end     clu
    &lt;char&gt; &lt;int&gt; &lt;int&gt;  &lt;char&gt;
1:    chr1 14829 14930 clu_1_-
2:    chr1 14829 14970 clu_1_-
3:    chr1 14829 15021 clu_1_-
4:    chr1 15947 16607 clu_2_-
5:    chr1 16310 16607 clu_2_-
6:    chr1 17055 17233 clu_3_-</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cnts1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 36048     4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cnts2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   seqname start   end     clu  end2
    &lt;char&gt; &lt;int&gt; &lt;int&gt;  &lt;char&gt; &lt;num&gt;
1:    chr1 14829 14929 clu_1_- 14930
2:    chr1 14829 14969 clu_1_- 14970
3:    chr1 14829 15020 clu_1_- 15021
4:    chr1 15947 16606 clu_2_- 16607
5:    chr1 16310 16606 clu_2_- 16607
6:    chr1 17055 17232 clu_3_- 17233</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cnts2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 36048     5</code></pre>
</div>
</div>
<p>Once converted cnt2 (BED) to leafcutter1 format, the coordinates are exactly the same.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  cnts1,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  cnts2[, .(seqname, start, <span class="at">end =</span> end2, clu, <span class="at">toy =</span> <span class="st">"toy"</span>)],</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"seqname"</span>, <span class="st">"start"</span>, <span class="st">"end"</span>, <span class="st">"clu"</span>),</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">multiple =</span> <span class="st">"any"</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  .[, .N, by <span class="ot">=</span> <span class="fu">is.na</span>(toy)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    is.na     N
   &lt;lgcl&gt; &lt;int&gt;
1:  FALSE 36048</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>jc.q <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">"./qn/FsjcOnLf1_junction_classifications.txt"</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>jc.v2onBed <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">"./qn/v2onBed_junction_classifications.txt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make jc.v2onBed coordinates the same as jc.q</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>jc.q <span class="ot">=</span> <span class="fu">separate</span>(jc.q, Intron_coord, <span class="fu">c</span>(<span class="st">"chrom"</span>, <span class="st">"start"</span>, <span class="st">"end"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"start"</span>, <span class="st">"end"</span>), as.integer) <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  as.data.table</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>jc.v2onBed <span class="ot">=</span> <span class="fu">separate</span>(jc.v2onBed, Intron_coord, <span class="fu">c</span>(<span class="st">"chrom"</span>, <span class="st">"start"</span>, <span class="st">"end"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"start"</span>, <span class="st">"end"</span>), as.integer) <span class="sc">%&gt;%</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  as.data.table <span class="sc">%&gt;%</span> </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  .[, .(Gene_name, chrom, start, <span class="at">end =</span> end <span class="sc">+</span><span class="dv">1</span>, Annot, Coding, UTR)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(jc.q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Gene_name  chrom  start    end Strand  Annot Coding    UTR
      &lt;char&gt; &lt;char&gt;  &lt;int&gt;  &lt;int&gt; &lt;char&gt; &lt;lgcl&gt; &lt;lgcl&gt; &lt;lgcl&gt;
1:     NOC2L   chr1 959081 959215      -   TRUE   TRUE  FALSE
2:     NOC2L   chr1 957273 958929      -   TRUE   TRUE  FALSE
3:     NOC2L   chr1 957025 957099      -   TRUE   TRUE  FALSE
4:     NOC2L   chr1 956215 956894      -   TRUE   TRUE  FALSE
5:     NOC2L   chr1 956013 956095      -   TRUE   TRUE  FALSE
6:     NOC2L   chr1 954523 955923      -   TRUE   TRUE  FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(jc.q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 31889     8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(jc.v2onBed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Gene_name  chrom  start    end  Annot Coding    UTR
      &lt;char&gt; &lt;char&gt;  &lt;int&gt;  &lt;num&gt; &lt;lgcl&gt; &lt;lgcl&gt; &lt;lgcl&gt;
1:     NOC2L   chr1 944800 945042   TRUE   TRUE  FALSE
2:     NOC2L   chr1 944800 945057   TRUE   TRUE  FALSE
3:     NOC2L   chr1 944819 945042  FALSE  FALSE  FALSE
4:     NOC2L   chr1 944819 945057  FALSE  FALSE  FALSE
5:     NOC2L   chr1 945146 945518   TRUE   TRUE  FALSE
6:     NOC2L   chr1 945422 945518   TRUE  FALSE  FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(jc.v2onBed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 31889     7</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>jc.q<span class="sc">$</span>lab <span class="ot">=</span> jc.q[, .(Annot, Coding, UTR)] <span class="sc">%&gt;%</span> <span class="fu">apply</span>(<span class="dv">1</span>, lgl2int)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>jc.v2onBed<span class="sc">$</span>lab <span class="ot">=</span> jc.v2onBed[, .(Annot, Coding, UTR)] <span class="sc">%&gt;%</span> <span class="fu">apply</span>(<span class="dv">1</span>, lgl2int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  jc.q[, .N, <span class="at">by =</span> .(lab)][, .(lab, N)][<span class="fu">order</span>(lab)],</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  jc.v2onBed[, .N, <span class="at">by =</span> .(lab)][, .(lab, N)][<span class="fu">order</span>(lab)],</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"lab"</span>,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">".qn"</span>, <span class="st">".v2onBed"</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  .[, </span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    .(lab, </span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>      N.qn,</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>      N.v2onBed,</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">P.qn =</span> N.qn<span class="sc">/</span><span class="fu">sum</span>(N.qn, <span class="at">na.rm =</span> T),</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">P.v2onBed =</span> N.v2onBed<span class="sc">/</span><span class="fu">sum</span>(N.v2onBed, <span class="at">na.rm =</span> T),</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">diff =</span> <span class="fu">abs</span>(N.qn <span class="sc">-</span> N.v2onBed)<span class="sc">/</span><span class="fu">sum</span>(N.qn, <span class="at">na.rm =</span> T)</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     lab  N.qn N.v2onBed        P.qn  P.v2onBed        diff
   &lt;int&gt; &lt;int&gt;     &lt;int&gt;       &lt;num&gt;      &lt;num&gt;       &lt;num&gt;
1:     0  4309      4966 0.135124965 0.15572768 0.020602716
2:     1  2155      1406 0.067578162 0.04409044 0.023487723
3:     2  1184      1338 0.037128790 0.04195804 0.004829251
4:     3    62        NA 0.001944244         NA          NA
5:     4  3169      3388 0.099375960 0.10624353 0.006867572
6:     5  1142       818 0.035811722 0.02565148 0.010160243
7:     6 16594     19973 0.520367525 0.62632883 0.105961303
8:     7  3274        NA 0.102668632         NA          NA</code></pre>
</div>
</div>
<section id="introns-where-qns-is-7-and-v2onbed-is-not" class="level3">
<h3 class="anchored" data-anchor-id="introns-where-qns-is-7-and-v2onbed-is-not">Introns where qn’s is 7 and v2onBed is not</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  jc.q[lab <span class="sc">==</span> <span class="dv">7</span>],</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  jc.v2onBed,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Gene_name"</span>, <span class="st">"chrom"</span>, <span class="st">"start"</span>, <span class="st">"end"</span>),</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">".qn"</span>, <span class="st">".v2onBed"</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  .[, .(lab.qn, lab.v2onBed)] <span class="sc">%&gt;%</span> unique</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   lab.qn lab.v2onBed
    &lt;int&gt;       &lt;int&gt;
1:      7           6</code></pre>
</div>
</div>
</section>
<section id="both-version-joins-completelly-on-coordinates-so-the-coordinates-are-the-same." class="level3">
<h3 class="anchored" data-anchor-id="both-version-joins-completelly-on-coordinates-so-the-coordinates-are-the-same.">Both version joins completelly on coordinates, so the coordinates are the same.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># join</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  jc.q[, <span class="sc">-</span>(<span class="fu">c</span>(<span class="st">"Annot"</span>, <span class="st">"Coding"</span>, <span class="st">"UTR"</span>))], </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  jc.v2onBed[, <span class="sc">-</span>(<span class="fu">c</span>(<span class="st">"Annot"</span>, <span class="st">"Coding"</span>, <span class="st">"UTR"</span>))],</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Gene_name"</span>, <span class="st">"chrom"</span>, <span class="st">"start"</span>, <span class="st">"end"</span>),</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">".q"</span>, <span class="st">".v2onBed"</span>)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Gene_name  chrom     start       end Strand lab.q lab.v2onBed
          &lt;char&gt; &lt;char&gt;     &lt;int&gt;     &lt;num&gt; &lt;char&gt; &lt;int&gt;       &lt;int&gt;
    1:     NOC2L   chr1    959081    959215      -     6           6
    2:     NOC2L   chr1    957273    958929      -     6           6
    3:     NOC2L   chr1    957025    957099      -     6           6
    4:     NOC2L   chr1    956215    956894      -     6           6
    5:     NOC2L   chr1    956013    956095      -     6           6
   ---                                                              
31885:     PGBD2   chr1 248913879 248936582      +     0           1
31886:     PGBD2   chr1 248914559 248916602      +     0           0
31887:     PGBD2   chr1 248916067 248916602      +     0           0
31888:     PGBD2   chr1 248917007 248917279      +     0           1
31889:     PGBD2   chr1 248917149 248917279      +     0           1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  jc.q[, <span class="sc">-</span>(<span class="fu">c</span>(<span class="st">"Annot"</span>, <span class="st">"Coding"</span>, <span class="st">"UTR"</span>))], </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  jc.v2onBed[, <span class="sc">-</span>(<span class="fu">c</span>(<span class="st">"Annot"</span>, <span class="st">"Coding"</span>, <span class="st">"UTR"</span>))],</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Gene_name"</span>, <span class="st">"chrom"</span>, <span class="st">"start"</span>, <span class="st">"end"</span>),</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">".q"</span>, <span class="st">".v2onBed"</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  .[<span class="fu">is.na</span>(lab.q) <span class="sc">|</span> <span class="fu">is.na</span>(lab.v2onBed)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Empty data.table (0 rows and 7 cols): Gene_name,chrom,start,end,Strand,lab.q...</code></pre>
</div>
</div>
</section>
<section id="whats-the-difference-in-introns-in-classfications-vs.-in-counts" class="level3">
<h3 class="anchored" data-anchor-id="whats-the-difference-in-introns-in-classfications-vs.-in-counts">what’s the difference in introns in classfications vs.&nbsp;in counts?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cnts2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 36048     5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(jc.v2onBed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 31889     8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cnts2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   seqname start   end     clu  end2
    &lt;char&gt; &lt;int&gt; &lt;int&gt;  &lt;char&gt; &lt;num&gt;
1:    chr1 14829 14929 clu_1_- 14930
2:    chr1 14829 14969 clu_1_- 14970
3:    chr1 14829 15020 clu_1_- 15021
4:    chr1 15947 16606 clu_2_- 16607
5:    chr1 16310 16606 clu_2_- 16607
6:    chr1 17055 17232 clu_3_- 17233</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(jc.v2onBed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Gene_name  chrom  start    end  Annot Coding    UTR   lab
      &lt;char&gt; &lt;char&gt;  &lt;int&gt;  &lt;num&gt; &lt;lgcl&gt; &lt;lgcl&gt; &lt;lgcl&gt; &lt;int&gt;
1:     NOC2L   chr1 944800 945042   TRUE   TRUE  FALSE     6
2:     NOC2L   chr1 944800 945057   TRUE   TRUE  FALSE     6
3:     NOC2L   chr1 944819 945042  FALSE  FALSE  FALSE     0
4:     NOC2L   chr1 944819 945057  FALSE  FALSE  FALSE     0
5:     NOC2L   chr1 945146 945518   TRUE   TRUE  FALSE     6
6:     NOC2L   chr1 945422 945518   TRUE  FALSE  FALSE     4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(jc.v2onBed<span class="sc">$</span>Gene_name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>joined1 <span class="ot">=</span> <span class="fu">full_join</span>(</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  cnts2[, .(<span class="at">chrom =</span> seqname, start, <span class="at">end =</span> end2, clu)],</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  jc.v2onBed[, .(Gene_name, chrom, start, end, lab)],</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"chrom"</span>, <span class="st">"start"</span>, <span class="st">"end"</span>),</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in full_join(cnts2[, .(chrom = seqname, start, end = end2, clu)], : Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 394 of `x` matches multiple rows in `y`.
ℹ Row 1 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>joined1[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(joined1),<span class="dv">10</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     chrom     start       end        clu Gene_name   lab
    &lt;char&gt;     &lt;int&gt;     &lt;num&gt;     &lt;char&gt;    &lt;char&gt; &lt;int&gt;
 1:   chr1 218323201 218330948 clu_4045_+     RRP15     0
 2:   chr1 167431013 167431577       &lt;NA&gt;     CD247     4
 3:   chr1  90982370  91021990 clu_1138_-    ZNF644     6
 4:   chr1 169369550 169376540       &lt;NA&gt;     BLZF1     6
 5:   chr1  96769875  96770708       &lt;NA&gt;     PTBP2     6
 6:   chr1  25746783  25749255 clu_2915_+    MAN1C1     6
 7:   chr1 236414299 236417523 clu_4166_+   EDARADD     0
 8:   chr1  33118116  33120044       &lt;NA&gt;     AZIN2     6
 9:   chr1  31507638  31507855  clu_552_-      &lt;NA&gt;    NA
10:   chr1 144995200 145011032 clu_1390_-   SRGAP2B     0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>joined1[, .N, by <span class="ot">=</span> .(<span class="at">inSJC =</span> <span class="sc">!</span><span class="fu">is.na</span>(Gene_name), <span class="at">inCNT =</span> <span class="sc">!</span><span class="fu">is.na</span>(clu))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    inSJC  inCNT     N
   &lt;lgcl&gt; &lt;lgcl&gt; &lt;int&gt;
1:  FALSE   TRUE  5356
2:   TRUE   TRUE 31567
3:   TRUE  FALSE 12910</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="check-v2-classifier-vs.-v3-classifier" class="level1">
<h1>Check v2 Classifier vs.&nbsp;v3 Classifier</h1>
<p>v2 missed a line in parse-annotation func where start coord is converted to 0 based bed. v3 fixed that. Because that cooordinates are only used for ss2gene, and ss2gene is not used in the subsequent functions, this does nto affect the result.</p>
<hr>
</section>
<section id="check-qns-classifer-vs.-qns-classifier-with-bed-v2-results" class="level1">
<h1>Check Qns’ classifer vs.&nbsp;Qn’s Classifier with BED (v2) results</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>jc.q <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">"./qn/FsjcOnLf1_junction_classifications.txt"</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>jc.q2 <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">"./qn/Fsjc2OnBed_junction_classifications.txt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>jc.q <span class="ot">=</span> <span class="fu">separate</span>(jc.q, Intron_coord, <span class="fu">c</span>(<span class="st">"chrom"</span>, <span class="st">"start"</span>, <span class="st">"end"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"start"</span>, <span class="st">"end"</span>), as.integer) <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  as.data.table</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>jc.q2 <span class="ot">=</span> <span class="fu">separate</span>(jc.q2, Intron_coord, <span class="fu">c</span>(<span class="st">"chrom"</span>, <span class="st">"start"</span>, <span class="st">"end"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"start"</span>, <span class="st">"end"</span>), as.integer) <span class="sc">%&gt;%</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  as.data.table <span class="sc">%&gt;%</span> </span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  .[, .(Gene_name, chrom, start, end, <span class="at">end2 =</span> end <span class="sc">+</span><span class="dv">1</span>, Annot, Coding, UTR)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(jc.q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Gene_name  chrom  start    end Strand  Annot Coding    UTR
      &lt;char&gt; &lt;char&gt;  &lt;int&gt;  &lt;int&gt; &lt;char&gt; &lt;lgcl&gt; &lt;lgcl&gt; &lt;lgcl&gt;
1:     NOC2L   chr1 959081 959215      -   TRUE   TRUE  FALSE
2:     NOC2L   chr1 957273 958929      -   TRUE   TRUE  FALSE
3:     NOC2L   chr1 957025 957099      -   TRUE   TRUE  FALSE
4:     NOC2L   chr1 956215 956894      -   TRUE   TRUE  FALSE
5:     NOC2L   chr1 956013 956095      -   TRUE   TRUE  FALSE
6:     NOC2L   chr1 954523 955923      -   TRUE   TRUE  FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(jc.q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 31889     8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(jc.q2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Gene_name  chrom  start    end   end2  Annot Coding    UTR
      &lt;char&gt; &lt;char&gt;  &lt;int&gt;  &lt;int&gt;  &lt;num&gt; &lt;lgcl&gt; &lt;lgcl&gt; &lt;lgcl&gt;
1:     NOC2L   chr1 959081 959214 959215   TRUE   TRUE  FALSE
2:     NOC2L   chr1 957273 958928 958929   TRUE   TRUE  FALSE
3:     NOC2L   chr1 957025 957098 957099   TRUE   TRUE  FALSE
4:     NOC2L   chr1 956215 956893 956894   TRUE   TRUE  FALSE
5:     NOC2L   chr1 956013 956094 956095   TRUE   TRUE  FALSE
6:     NOC2L   chr1 954523 955922 955923   TRUE   TRUE  FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(jc.q2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 31889     8</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>jc.q[, .N, by <span class="ot">=</span> .(Annot, Coding, UTR)][, .(Annot, Coding, UTR, N, <span class="at">P =</span> N<span class="sc">/</span><span class="fu">sum</span>(N))][<span class="fu">order</span>(Annot, Coding, UTR)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Annot Coding    UTR     N           P
   &lt;lgcl&gt; &lt;lgcl&gt; &lt;lgcl&gt; &lt;int&gt;       &lt;num&gt;
1:  FALSE  FALSE  FALSE  4309 0.135124965
2:  FALSE  FALSE   TRUE  2155 0.067578162
3:  FALSE   TRUE  FALSE  1184 0.037128790
4:  FALSE   TRUE   TRUE    62 0.001944244
5:   TRUE  FALSE  FALSE  3169 0.099375960
6:   TRUE  FALSE   TRUE  1142 0.035811722
7:   TRUE   TRUE  FALSE 16594 0.520367525
8:   TRUE   TRUE   TRUE  3274 0.102668632</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>jc.q2[, .N, by <span class="ot">=</span> .(Annot, Coding, UTR)][, .(Annot, Coding, UTR, N, <span class="at">P =</span> N<span class="sc">/</span><span class="fu">sum</span>(N))][<span class="fu">order</span>(Annot, Coding, UTR)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Annot Coding    UTR     N           P
   &lt;lgcl&gt; &lt;lgcl&gt; &lt;lgcl&gt; &lt;int&gt;       &lt;num&gt;
1:  FALSE  FALSE  FALSE  4309 0.135124965
2:  FALSE  FALSE   TRUE  2155 0.067578162
3:  FALSE   TRUE  FALSE  1184 0.037128790
4:  FALSE   TRUE   TRUE    62 0.001944244
5:   TRUE  FALSE  FALSE  3169 0.099375960
6:   TRUE  FALSE   TRUE  1142 0.035811722
7:   TRUE   TRUE  FALSE 16594 0.520367525
8:   TRUE   TRUE   TRUE  3274 0.102668632</code></pre>
</div>
</div>
</section>
<section id="check-v1-leafcutter_regtools-vs.-v2-updated-leafcutter_regtools" class="level1">
<h1>check v1 leafcutter_regtools vs.&nbsp;v2 updated leafcutter_regtools</h1>
<section id="run1-results---og-script-with-0based-intron-and-1off-bug-1" class="level2">
<h2 class="anchored" data-anchor-id="run1-results---og-script-with-0based-intron-and-1off-bug-1">run1 results - OG script with 0based intron, and 1off bug</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># classified junctions</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>jfc1 <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">"./run1/run1_junction_classifications.txt"</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>cnts1 <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">"./run1/run1_perind.counts.noise_by_intron.gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>cnts1[, itype <span class="sc">:</span><span class="er">=</span> <span class="fu">str_extract</span>(chrom, <span class="st">"</span><span class="sc">\\</span><span class="st">w+$"</span>)]</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>cnts1[, coord <span class="sc">:</span><span class="er">=</span> <span class="fu">str_remove</span>(chrom, <span class="st">"</span><span class="sc">\\</span><span class="st">:</span><span class="sc">\\</span><span class="st">w+$"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cnts1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           chrom NA18486.junc NA18487.junc NA18488.junc
                          &lt;char&gt;       &lt;char&gt;       &lt;char&gt;       &lt;char&gt;
1: chr1:827775:829002:clu_1_+:IN        21/24        15/18          7/9
2: chr1:827849:829002:clu_1_+:IN         3/24         0/18          0/9
3: chr1:827853:829002:clu_1_+:IN         0/24         3/18          2/9
4: chr1:829104:841199:clu_2_+:IN        11/39         6/25         8/16
5: chr1:829104:847653:clu_2_+:IN         4/39         3/25         3/16
6: chr1:829104:851926:clu_2_+:IN         7/39         8/25         0/16
   NA184898.junc NA184899.junc NA18489.junc  itype                      coord
          &lt;char&gt;        &lt;char&gt;       &lt;char&gt; &lt;char&gt;                     &lt;char&gt;
1:         27/28           8/9        25/30     IN chr1:827775:829002:clu_1_+
2:          1/28           1/9         2/30     IN chr1:827849:829002:clu_1_+
3:          0/28           0/9         3/30     IN chr1:827853:829002:clu_1_+
4:          7/28          3/11        14/33     IN chr1:829104:841199:clu_2_+
5:          7/28          3/11         4/33     IN chr1:829104:847653:clu_2_+
6:          4/28          1/11         5/33     IN chr1:829104:851926:clu_2_+</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cnts1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9301    9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(cnts1<span class="sc">$</span>itype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "IN" "UP" "PR" "NE"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>cnts1[, .N, by <span class="ot">=</span> itype][, .(itype, N, <span class="at">P =</span> N<span class="sc">/</span><span class="fu">sum</span>(N))][<span class="fu">order</span>(<span class="sc">-</span>N)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    itype     N          P
   &lt;char&gt; &lt;int&gt;      &lt;num&gt;
1:     PR  5520 0.59348457
2:     UP  2788 0.29975271
3:     NE   555 0.05967100
4:     IN   438 0.04709171</code></pre>
</div>
</div>
</section>
<section id="run3-results---bug-fixed-plus-quinns-update" class="level2">
<h2 class="anchored" data-anchor-id="run3-results---bug-fixed-plus-quinns-update">run3 results - bug fixed plus Quinn’s update</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># classified junctions</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>jfc3 <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">"./run3/run3_junction_classifications.txt"</span>)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>cnts3 <span class="ot">=</span> <span class="fu">fread</span>(<span class="st">"./run3/run3_perind.counts.noise_by_intron.gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>cnts3[, itype <span class="sc">:</span><span class="er">=</span> <span class="fu">str_extract</span>(chrom, <span class="st">"</span><span class="sc">\\</span><span class="st">w+$"</span>)]</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>cnts3[, coord <span class="sc">:</span><span class="er">=</span> <span class="fu">str_remove</span>(chrom, <span class="st">"</span><span class="sc">\\</span><span class="st">:</span><span class="sc">\\</span><span class="st">w+$"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cnts3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           chrom NA18486.junc NA18487.junc NA18488.junc
                          &lt;char&gt;       &lt;char&gt;       &lt;char&gt;       &lt;char&gt;
1: chr1:827775:829002:clu_1_+:IN        21/24        15/18          7/9
2: chr1:827849:829002:clu_1_+:IN         3/24         0/18          0/9
3: chr1:827853:829002:clu_1_+:IN         0/24         3/18          2/9
4: chr1:829104:841199:clu_2_+:IN        11/39         6/25         8/16
5: chr1:829104:847653:clu_2_+:IN         4/39         3/25         3/16
6: chr1:829104:851926:clu_2_+:IN         7/39         8/25         0/16
   NA184898.junc NA184899.junc NA18489.junc  itype                      coord
          &lt;char&gt;        &lt;char&gt;       &lt;char&gt; &lt;char&gt;                     &lt;char&gt;
1:         27/28           8/9        25/30     IN chr1:827775:829002:clu_1_+
2:          1/28           1/9         2/30     IN chr1:827849:829002:clu_1_+
3:          0/28           0/9         3/30     IN chr1:827853:829002:clu_1_+
4:          7/28          3/11        14/33     IN chr1:829104:841199:clu_2_+
5:          7/28          3/11         4/33     IN chr1:829104:847653:clu_2_+
6:          4/28          1/11         5/33     IN chr1:829104:851926:clu_2_+</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cnts3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9301    9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(cnts3<span class="sc">$</span>itype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "IN" "PR" "UP"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>cnts3[, .N, by <span class="ot">=</span> itype][, .(itype, N, <span class="at">P =</span> N<span class="sc">/</span><span class="fu">sum</span>(N))][<span class="fu">order</span>(<span class="sc">-</span>N)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    itype     N          P
   &lt;char&gt; &lt;int&gt;      &lt;num&gt;
1:     PR  6176 0.66401462
2:     UP  2687 0.28889367
3:     IN   438 0.04709171</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># jfc3[, key := map_vec(Intron_coord, coord_to_key)]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="run1--run3---compare-annot" class="level2">
<h2 class="anchored" data-anchor-id="run1--run3---compare-annot">run1 -run3 - compare annot</h2>
<section id="overall-differences-by-category-1" class="level3">
<h3 class="anchored" data-anchor-id="overall-differences-by-category-1">Overall differences by category</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<div id="aarnihuhln" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#aarnihuhln table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#aarnihuhln thead, #aarnihuhln tbody, #aarnihuhln tfoot, #aarnihuhln tr, #aarnihuhln td, #aarnihuhln th {
  border-style: none;
}

#aarnihuhln p {
  margin: 0;
  padding: 0;
}

#aarnihuhln .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#aarnihuhln .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#aarnihuhln .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#aarnihuhln .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#aarnihuhln .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aarnihuhln .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aarnihuhln .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aarnihuhln .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#aarnihuhln .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#aarnihuhln .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#aarnihuhln .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#aarnihuhln .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#aarnihuhln .gt_spanner_row {
  border-bottom-style: hidden;
}

#aarnihuhln .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#aarnihuhln .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#aarnihuhln .gt_from_md > :first-child {
  margin-top: 0;
}

#aarnihuhln .gt_from_md > :last-child {
  margin-bottom: 0;
}

#aarnihuhln .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#aarnihuhln .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#aarnihuhln .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#aarnihuhln .gt_row_group_first td {
  border-top-width: 2px;
}

#aarnihuhln .gt_row_group_first th {
  border-top-width: 2px;
}

#aarnihuhln .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aarnihuhln .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#aarnihuhln .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#aarnihuhln .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aarnihuhln .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aarnihuhln .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#aarnihuhln .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#aarnihuhln .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#aarnihuhln .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aarnihuhln .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aarnihuhln .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aarnihuhln .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aarnihuhln .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aarnihuhln .gt_left {
  text-align: left;
}

#aarnihuhln .gt_center {
  text-align: center;
}

#aarnihuhln .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#aarnihuhln .gt_font_normal {
  font-weight: normal;
}

#aarnihuhln .gt_font_bold {
  font-weight: bold;
}

#aarnihuhln .gt_font_italic {
  font-style: italic;
}

#aarnihuhln .gt_super {
  font-size: 65%;
}

#aarnihuhln .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#aarnihuhln .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#aarnihuhln .gt_indent_1 {
  text-indent: 5px;
}

#aarnihuhln .gt_indent_2 {
  text-indent: 10px;
}

#aarnihuhln .gt_indent_3 {
  text-indent: 15px;
}

#aarnihuhln .gt_indent_4 {
  text-indent: 20px;
}

#aarnihuhln .gt_indent_5 {
  text-indent: 25px;
}

#aarnihuhln .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#aarnihuhln div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="itype" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">itype</th>
<th id="N.run1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">N.run1</th>
<th id="P.run1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">P.run1</th>
<th id="N.run3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">N.run3</th>
<th id="P.run3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">P.run3</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="itype">PR</td>
<td class="gt_row gt_right" headers="N.run1">5520</td>
<td class="gt_row gt_right" headers="P.run1">0.59348457</td>
<td class="gt_row gt_right" headers="N.run3">6176</td>
<td class="gt_row gt_right" headers="P.run3">0.66401462</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="itype">UP</td>
<td class="gt_row gt_right" headers="N.run1">2788</td>
<td class="gt_row gt_right" headers="P.run1">0.29975271</td>
<td class="gt_row gt_right" headers="N.run3">2687</td>
<td class="gt_row gt_right" headers="P.run3">0.28889367</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="itype">IN</td>
<td class="gt_row gt_right" headers="N.run1">438</td>
<td class="gt_row gt_right" headers="P.run1">0.04709171</td>
<td class="gt_row gt_right" headers="N.run3">438</td>
<td class="gt_row gt_right" headers="P.run3">0.04709171</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="check-all-coordinates-are-the-same-1" class="level3">
<h3 class="anchored" data-anchor-id="check-all-coordinates-are-the-same-1">Check all coordinates are the same</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">uniqueN</span>(cnts1<span class="sc">$</span>coord), <span class="fu">uniqueN</span>(cnts1<span class="sc">$</span>coord), <span class="fu">nrow</span>(cnts1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9301 9301 9301</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">uniqueN</span>(cnts3<span class="sc">$</span>coord), <span class="fu">uniqueN</span>(cnts3<span class="sc">$</span>coord), <span class="fu">nrow</span>(cnts3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9301 9301 9301</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">intersect</span>(cnts1<span class="sc">$</span>coord, cnts3<span class="sc">$</span>coord) <span class="sc">%&gt;%</span> <span class="fu">uniqueN</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9301</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>checkdf <span class="ot">=</span> <span class="fu">left_join</span>(</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  cnts1[, .(coord, itype)],</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  cnts3[, .(coord, itype)],</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"coord"</span>, <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">".run1"</span>, <span class="st">".run3"</span>),</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">same =</span> itype.run1 <span class="sc">==</span> itype.run3) <span class="sc">%&gt;%</span> </span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">itype3 =</span> <span class="fu">paste0</span>(itype.run1, <span class="st">","</span>, itype.run3)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="introns-with-same-classification-1" class="level3">
<h3 class="anchored" data-anchor-id="introns-with-same-classification-1">introns with same classification</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>checkdf[same <span class="sc">==</span> <span class="cn">TRUE</span>, .N, by <span class="ot">=</span> itype3][<span class="fu">order</span>(<span class="sc">-</span>N)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   itype3     N
   &lt;char&gt; &lt;int&gt;
1:  PR,PR  5381
2:  UP,UP  2078
3:  IN,IN   438</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># checkdf[same == TRUE]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="introns-with-diff-classification-1" class="level3">
<h3 class="anchored" data-anchor-id="introns-with-diff-classification-1">introns with diff classification</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>checkdf[same <span class="sc">==</span> F, .N, by <span class="ot">=</span> itype3][<span class="fu">order</span>(<span class="sc">-</span>N)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   itype3     N
   &lt;char&gt; &lt;int&gt;
1:  UP,PR   710
2:  NE,UP   470
3:  PR,UP   139
4:  NE,PR    85</code></pre>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>